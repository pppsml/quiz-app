class ConstructorScreen{constructor(){this.currentAnswer=0,this.currentConstuctorQuestion=data.newQuizData.quiz.length+1,config.currentScreen="constructor",quizContainer.append(this.loadScreen()),checkBurgerBtn()}loadScreen(){const e=document.getElementById("btn__create"),t=document.getElementById("btn__startScreen");e.classList.add("dn"),t.classList.remove("dn"),selectQuizContainer.innerHTML="",quizContainer.innerHTML="";const n=getElement("form",[],{id:"_constructor"});n.addEventListener("submit",(e=>{e.preventDefault()})),n.append(getElement("h2",["title"],{textContent:"Quiz constructor"})),n.append(getElement("p",["text","text-minimal"],{textContent:"(fill in all the fields)"})),n.append(getElement("p",["text","text-minimal"],{textContent:"(press on create quiz button after creating question)"}));const r=getElement("div",["row"]);n.append(getElement("p",["text","tal"],{textContent:`Question â„–${this.currentConstuctorQuestion}: `})),r.append(getElement("input",["text","tal"],{type:"text",name:"question",autocomplete:"off",placeholder:"(min 8, max 150)",minLength:"8",maxLength:"150",required:"true"})),n.append(r),n.append(getElement("p",["text","tal"],{textContent:"Answers:"})),n.append(getElement("p",["text","text-minimal","tal"],{textContent:`(min: 3, max: ${config.maxAnwerOptions})`}));const a=getElement("div",["answer__container"],{id:"answerContainer"});n.append(a);const i=getElement("div",["row","row__btns"]);this.addAnswerBtn=getElement("button",["btn__styled","btn__circle"],{type:"button",alt:"Add more answer option",title:"Add more answer option",textContent:"+"}),this.removeAnswerBtn=getElement("button",["btn__styled","btn__circle"],{type:"button",alt:"Remove last answer option",title:"Remove last answer option",textContent:"-"}),this.addAnswerBtn.addEventListener("click",(()=>a.append(this.createAnswerInput()))),this.removeAnswerBtn.addEventListener("click",(()=>this.removeAnswerInput())),i.append(this.addAnswerBtn),i.append(this.removeAnswerBtn),n.append(i);for(let e=0;e<3;e++)a.append(this.createAnswerInput());const o=getElement("div",["row"]),s=getElement("p",["text"],{textContent:"Correct: "});s.style.flexBasis="40%",o.append(s),o.append(getElement("input",["text","tal"],{type:"text",name:"correct",placeholder:`From "${config.answerOptions[0]}" to "${config.answerOptions[2]}"`,autocomplete:"off",required:"true",minLength:"1",maxLength:"1",pattern:`[${config.answerOptions[0]}-${config.answerOptions[2]}]`})),n.append(o);const c=0==data.newQuizData.quiz.length,u=getElement("button",["btn__styled","btn__big"],{type:"submit",textContent:"Create quiz",disabled:c});u.addEventListener("click",(e=>{this.newQuiz(e)}));const l=getElement("button",["btn__styled","btn__big"],{type:"submit",textContent:"New question"});l.addEventListener("click",this.newQuestion);const d=getElement("div",["row","big__btn-container"]);return d.append(u),d.append(l),n.append(d),n}newQuiz(e){if(e.preventDefault(),data.newQuizData.quiz.length>0){loadModal("newQuiz");const e=document.getElementById("modal");toggleElem(e);const t=document.getElementById("newQuizBtn"),n=document.forms._modal;n.addEventListener("submit",(e=>{t.disabled=!0,e.preventDefault();const r=n.querySelector('input[name="quizName"]').value.trim(),a=+new Date;data.newQuizData.name=r,data.newQuizData.id=a,data.newQuizData.likes=0,_quizzes.doc(`${a}`).withConverter(quizConverter).set(data.newQuizData).then((()=>{alert("Quiz successfully created!"),localStorage.setItem("newQuizData",""),location.reload()})).catch((e=>{console.error("Error creating quiz: ",e),alert("Error creating quiz: ",e),t.disabled=!1}))}))}}newQuestion(){const e=document.forms._constructor;if(inputValidation(e)){const t=[],n=/ +/g,r=e.querySelector('input[name="question"]').value.trim().replace(n," "),a=e.querySelectorAll('input[name="answer"]'),i=e.querySelector('input[name="correct"]').value.trim().replace(n," ");a.forEach((e=>t.push(e.value.trim().replace(n," "))));let o={question:`${r}`,answers:[...t],correct:`${i}`};data.newQuizData.quiz.push(o),localStorage.setItem("newQuizData",JSON.stringify(data.newQuizData.quiz)),this.currentConstuctorQuestion++,new ConstructorScreen}}createAnswerInput(){const e=getElement("div",["row","answer__option"]),t=getElement("p",["text"],{textContent:`${config.answerOptions[this.currentAnswer]}:`}),n=getElement("input",["text","tal"],{name:"answer",autocomplete:"off",placeholder:"(min 2, max 85)",minLength:"2",maxLength:"85",required:"true"});return this.currentAnswer++,e.append(t),e.append(n),this.updateBtn(),e}removeAnswerInput(){document.querySelectorAll(".answer__option")[this.currentAnswer-1].remove(),this.currentAnswer--,this.updateBtn()}updateBtn(){this.addAnswerBtn.disabled=this.currentAnswer>config.maxAnwerOptions-1,this.removeAnswerBtn.disabled=this.currentAnswer<4;const e=document.querySelector('input[name="correct"]');e&&(e.placeholder=`From "${config.answerOptions[0]}" to "${config.answerOptions[this.currentAnswer-1]}"`,e.pattern=`[${config.answerOptions[0]}-${config.answerOptions[this.currentAnswer-1]}]`)}}